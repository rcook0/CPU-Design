<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 7.3.7.2 (Linux)"/>
	<meta name="created" content="2025-09-10T12:36:32.313270275"/>
	<meta name="changed" content="2025-09-10T12:38:12.918379270"/>
	<style type="text/css">
		@page { size: 21cm 29.7cm; margin: 2cm }
		p { line-height: 115%; margin-bottom: 0.25cm; background: transparent }
		h1 { margin-bottom: 0.21cm; background: transparent; page-break-after: avoid }
		h1.western { font-family: "Liberation Serif", serif; font-size: 24pt; font-weight: bold }
		h1.cjk { font-family: "Noto Serif CJK SC"; font-size: 24pt; font-weight: bold }
		h1.ctl { font-family: "Lohit Devanagari"; font-size: 24pt; font-weight: bold }
		strong { font-weight: bold }
		code.western { font-family: "Liberation Mono", monospace }
		code.cjk { font-family: "Noto Sans Mono CJK SC", monospace }
		code.ctl { font-family: "Liberation Mono", monospace }
	</style>
</head>
<body lang="da-DK" link="#000080" vlink="#800000" dir="ltr"><p>A
complete, <strong>pure-simulation</strong> mid-sized pipelined CPU in
<strong>Verilog</strong> with a simple L1 cache (direct-mapped,
write-through, configurable latency), a toy 32-bit ISA, and a
testbench that runs a short program. I made tradeoffs to keep it
realistic but understandable:</p>
<ul>
	<li><p>5-stage pipeline (IF → ID → EX → MEM → WB) with
	pipeline registers.</p>
	<li><p>Register file with two read ports + one write port.</p>
	<li><p>Simple forwarding (EX → ID/EX and MEM → EX) and a
	load-use stall.</p>
	<li><p>L1 cache: direct-mapped, write-through, configurable hit
	latency and miss latency (misses stall pipeline for simplicity).</p>
	<li><p>Instruction memory (IMEM) and main data memory (DMEM) are
	behavioral arrays; IMEM preloaded in the testbench.</p>
	<li><p>Toy ISA: R-type, I-type (ALU immediate), LD, ST, BEQ, JAL,
	and NOP.</p>
</ul>
<p>Copy-paste the files below into a single <code class="western">.v</code>
file (or split them) and run with Icarus Verilog / ModelSim / VCS.</p>
<hr/>

<h1 class="western">Toy ISA (32-bit instruction)</h1>
<p>All fields are big-endian bit positions ( <code class="western">[31:0]</code>
):</p>
<ul>
	<li><p>R-type: <code class="western">opcode[31:26]=6'b000000</code>,
	<code class="western">rd[25:21]</code>, <code class="western">rs1[20:16]</code>,
	<code class="western">rs2[15:11]</code>, <code class="western">funct[10:0]</code></p>
	<ul>
		<li><p>funct defines add/sub/and/or/xor/shl, etc.</p>
	</ul>
	<li><p>I-type ALU immediate: <code class="western">opcode =
	6'b001000</code>, <code class="western">rd[25:21]</code>,
	<code class="western">rs1[20:16]</code>, <code class="western">imm[15:0]</code>
	(sign-extended)</p>
	<li><p>LD (load word): <code class="western">opcode = 6'b010000</code>,
	<code class="western">rd[25:21]</code>, <code class="western">rs1[20:16]</code>,
	<code class="western">imm[15:0]</code></p>
	<li><p>ST (store word): <code class="western">opcode = 6'b010001</code>,
	<code class="western">rs2[25:21]</code>, <code class="western">rs1[20:16]</code>,
	<code class="western">imm[15:0]</code> (store rs2 -&gt; [rs1+imm])</p>
	<li><p>BEQ: <code class="western">opcode = 6'b011000</code>,
	<code class="western">rs1[25:21]</code>, <code class="western">rs2[20:16]</code>,
	<code class="western">imm[15:0]</code> (PC-relative words)</p>
	<li><p>JAL: <code class="western">opcode = 6'b011001</code>,
	<code class="western">rd[25:21]</code>, <code class="western">imm[20:0]</code>
	(jump and link; imm sign-extended * 4)</p>
	<li><p>NOP: <code class="western">32'h00000000</code></p>
</ul>
<p>Registers: 32 regs x32-bit. Register 0 is wired to zero.</p>
<p>ALU operations for R-type determined by <code class="western">funct[3:0]</code>:</p>
<ul>
	<li><p><code class="western">0000</code> = ADD</p>
	<li><p><code class="western">0001</code> = SUB</p>
	<li><p><code class="western">0010</code> = AND</p>
	<li><p><code class="western">0011</code> = OR</p>
	<li><p><code class="western">0100</code> = XOR</p>
	<li><p><code class="western">0101</code> = SLL</p>
	<li><p><code class="western">0110</code> = SRL</p>
	<li><p><code class="western">0111</code> = SRA<br/>
(You can add
	more.)</p>
</ul>
<hr/>

<h1 class="western">Files / Modules</h1>
<p>Below are all modules in-order: <code class="western">regfile.v</code>,
<code class="western">alu.v</code>, <code class="western">imem.v</code>,
<code class="western">dmem.v</code>, <code class="western">l1cache.v</code>,
<code class="western">cpu.v</code> (top CPU), and <code class="western">tb.v</code>
(testbench).</p>
<p style="line-height: 100%; margin-bottom: 0cm"><br/>

</p>
</body>
</html>